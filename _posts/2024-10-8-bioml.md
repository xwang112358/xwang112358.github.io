---
title: 'BioML Challenge 2024: Bits to Binders'
date: 2024-10-8
permalink: /posts/
tags:
  - De novo Binder Design
  - RFDiffusion
  - ProteinMPNN
  - AlphaFold
  - Chai-1
---

CAR-T cell therapy is a type of cancer treatment where a patient's own T cells， are genetically modified to fight cancer. The process involves extracting T cells from the patient, engineering them to express a Chimeric Antigen Receptor (CAR) that specifically targets cancer cells, and then reintroducing these modified cells into the patient's body. Once inside the patient body, the CAR-T cells recognize and attack the cancer cells, helping to eliminate the tumor. An open question in the field of CAR-T cell therapy is how to design effective antigen-binding domains that can specifically target cancer antigens and trigger a robust immune response. 

<div style="text-align: center;">
  <img src="/images/CAR-T.png" alt="CAR-T Therapy" style="width: 75%;"/>
  <p><em>Larson et al., 2021, Nature Reviews Cancer</em></p>
</div>

This project aims to design binding domains for a Chimeric Antigen Receptor (CAR) that will engage the extracellular region of cancer antigen [**CD20**](https://www.uniprot.org/uniprotkb/P11836/entry). The goal of this project is to gain practical experience in the binder design workflow, implement a standardized pipeline, and explore how different, SOTA generative models play a critical role in the design process. Furthermore, the project will apply advanced AI tools to the design challenge, observing both their capabilities and limitations in generating functional CAR antigen binders.

I want to Thank BioML for hosting this awesome [challenge](https://www.biomlsociety.org/challenge) and the members of the Meiler and NDS Labs for their valuable guidance on this project. The code and technical report will be available soon!

## Method Overview

I employed a standard pipeline encompassing backbone generation, inverse folding, and filtering to tackle the challenge. For binder design with the RFdiffusion model, our focus was on generating binder backbones that specifically target epitope 3 of CD20, located in the extracellular region. A diverse subset of these backbones was selected for inverse folding using ProteinMPNN, producing multiple sequence designs for each backbone. AlphaFold2 was then used to validate the 3D structures of the sequence designs by comparing the RMSD score to the original backbone. Finally, the Chai-1 model predicted the complex formed between CD20 and the filtered binder sequences. After excluding complex predictions that failed to meet the correct binding site and extracellular constraints, I ranked the binder sequences based on their iptm scores output by Chai-1.

## Understanding the Antigen **CD20**

Before starting the binder design, we need to fully understand our antigen target, CD20. The best approach is to visualize its 3D structure and identify the extracellular region as well as the potential binding site within it. We can download CD20's PDB file from [uniprot](https://www.uniprot.org/uniprotkb/P11836/entry) and use *PyMOL* to visualize the structure after removing unwanted ligands and proteins. From the uniprot, we learned that CD20's **Epitope 3: 168-175 (Sequence: EPANPSEK)** was recognized by antibodies, including Rituximab, through experiments. Then, we should keep in mind to design binders that interact with these amino acids and lie in the extracellular region. Here is a image that roughly circles the potential binding site of CD20 and segments the extracellular and the remaining regions.

<div style="text-align: center;">
  <img src="/images/understand_cd20.png" alt="Understanding CD20" style="width: 50%;" />
</div>


## Backbone Generation via [RFDiffusion](https://github.com/RosettaCommons/RFdiffusion/tree/main)

RFDiffusion is a computational tool used to design protein binders by leveraging diffusion models to generate novel protein structures. It plays a crucial role in binder design by sampling potential binder conformations that can interact specifically with a target protein. However, RFDiffusion can only generate the backbone of the binder without sequence information, which means further steps are needed to determine the amino acid sequence of the binder. For this challenge, I configured RFDiffusion with following considerations: (1) **extracellular region**, (2) **binding site**, and (3) **diversity of the designed binder**. 

By experimenting with RFDiffusion, I found truncating the target input and only keeping the extracellular part could prompt the model only generate binders in the extraceullar region. Besides, since RFDiffusion scales in runtime as $$O(N^2)$$ where $$N$$ is the number of amino acids in the system, trucating the protein target significantly reduced the inference run time for the large-scale design. 

RFDiffusion allows the user to define *hotspots*, which control the binder to interact with a specific site on the protein target. After carefully examining Epitope 3 mentioned earlier, and the complex including CD20 and existing antibodies, I defined a few hotspots that allow diverse binding scenarios.

To encourage the diversity of our designed binders, I adopted the *complex_beta* checkpoint of RFDiffusion, which can generate a greater diversity of topologies compared to the *base* model. Empirically, the *base* model could only generate simple helical binders that share high structural similarity. Additionally, we tuned *noise_scale_ca* and *noise_scale_frame* with values of 0, 0.5, and 1. These two hyperparameters indicate the noise added to the position of $$C_{\alpha}$$ and the frame (translation and rotation) during inference. Reducing the noise can improve the quality of binder designs, but at the expense of diversity. I generated approximately 10,000 binder backbones across three different noise levels and refined the selection by clustering to retain only a subset of diverse topologies. Specifically, I aligned all binder backbones, calculated an RMSD matrix, and performed hierarchical clustering with a cutoff of $$ \pu{5 Å}$$. From each resulting cluster, a representative binder was selected. This process yielded 1,500 diverse binder backbones for the inverse folding step.

<div style="text-align: center;">
  <img src="/images/backbone_diversity.png" alt="Diversity of generated backbone" style="width: 100%;" />
  <p><em>Comparision between beta and base model: by projecting the RMSD in 2D space, we can see the beta model on the left can generate more structural diverse binders, compared to the base model on the right. With the same cutoff value, more clusters (red cross) are derived from binders designed by the beta model.</em></p>
</div>

## Inverse Folding via ProteinMPNN


## Relaxed Filtering via AlphaFold2 Initial Guess


## Final Complex Validation via Chai-1

